<!--Page description & heading-->
<div class="grid_12" id="pagedescription">
	<h2><%= link_to "#{@job.job_number} - #{@job.name}", job_path(@job.id) %></h2>
	<h5><%= "#{@subcontractor.name}#{@sub_to}" %></h5>			
</div>

<div id="contentmiddle" class="grid_9">	

<!--control buttons-->	
	<div id="contentcontrol">
		
		<div class="grid_2"><h4>All Items</h4></div>
		
		<div class="controlbuttons">
			<ul>
				<li class="controls" id="receive_payments">
					<%= link_to "Add item", {:controller => "list_items", :action => "new", :partner_id => @subcontractor.id, :parent_id => @parent_id, :job_id => @job.id, :partner_type => 1, :name => @subcontractor.name}%>
				</li>
				<li class="controls" id="assign_sub">
					<%= link_to "Assign a subcontractor", {:controller => "assignments", :action => "new", :job_id => @job.id, :parent_id => @subcontractor.id, :partner_type => 1, :super_parent_id => @parent_id}%>
				</li>
				<li class="controls" id="assign_sub">
					<%= link_to "Assign a supplier", {:controller => "assignments", :action => "new", :job_id => @job.id, :parent_id => @subcontractor.id, :partner_type => 2, :super_parent_id => @parent_id}%>
				</li>
			</ul>
		</div>
	</div>
	
	<!--All the list items-->
	<%= render :partial => "index/sub_details", :locals => {:j => @subcontractor, :job_id => @job.id, :parent_id => @parent_id, :show_subname => 0, :status => @asg.status} %>
		
</div>

<div id="sidebar" class="grid_3">
	<h2>Vendor Details <span><%= link_to "Edit", {:controller => "vendors", :action => "edit", :id => @subcontractor.id} %></span></h2>

	<ul>
		<li class="list_headers">Contact person:</li>
		<li>Name: <span><%= @contact_person.name %></span></li>
		<li>Phone: <span><%= @contact_person.phone_number %></span></li>
		<li>E-mail: <span><%= @contact_person.email %></span></li>
		<li class="list_headers">Company address:</li>
		<li>Street: <span><%= @address.street %></span></li>
		<li>City: <span><%= @address.city %></span></li>
		<li>Zip: <span><%= @address.zip_code %></span></span></li>
		<li>State: <span><%= @address.state %></span></li>
	</ul>
	<div id="documents_section">
		<h2>Sub Docs:</h2>
		<% unless @asg.nil? || @asg.documents.length == 0 %>
			<% @asg.documents.each do |i| %>
				<div class="document_links"><img src="/images/<%= @fn = i.document_file_name; @fn[@fn.length-3, 3] %>.png" />  <%= link_to @fn[0, @fn.length-4], i.document.url %></div>
			<% end %>
		<% end %>
		<div id="add_doc_link"><img src="/images/plus.png" height="16px" width="16px"/> <%= link_to "Add a document", {:controller => "documents", :action => "new", :owner_type => "asg", :owner_id => @asg.id} %></div>		
	</div>
</div>

<div class="grid_12" id="contentbottom">
	<div id="recent_history">
	<legend>Sub's Job History - <%= link_to "See full history", {:controller => "histories", :action => "show", :job_id => @job.id, :parent_id => @parent_id, :partner_id => @subcontractor.id, :partner_type => 1}%></legend>
	
	<ul>
		<% unless @log.nil? then @log.each do |i| %>
				<li><%= i.target_type %> <%= i.target_name %> <span><%= i.action %> on</span> <%= i.date %> <span>at</span> <%= i.time %> <span>by Main User</span></li>
			<% end %>
		<% end %>
	</ul>
	</div>
</div>

<% #Page's method calls and global variable modifiers %>

<% $active_page = "subcontractor.show" %>